!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t,e){function n(t){function e(){a?(n(),O(e),i=!0,a=!1):i=!1}var n=t,a=!1,i=!1;this.kick=function(){a=!0,i||e()},this.end=function(t){var e=n;t&&(i?(n=a?function(){e(),t()}:t,a=!0):t())}}function a(){return!0}function i(){return!1}function o(t){t.preventDefault()}function r(t){z[t.target.tagName.toLowerCase()]||t.preventDefault()}function u(t){return 1===t.which&&!t.ctrlKey&&!t.altKey}function c(t,e){var n,a;if(t.identifiedTouch)return t.identifiedTouch(e);for(n=-1,a=t.length;++n<a;)if(t[n].identifier===e)return t[n]}function d(t,e){var n=c(t.changedTouches,e.identifier);if(n&&(n.pageX!==e.pageX||n.pageY!==e.pageY))return n}function m(t){var e;u(t)&&(e={target:t.target,startX:t.pageX,startY:t.pageY,timeStamp:t.timeStamp},K(document,Q.move,f,e),K(document,Q.cancel,s,e))}function f(t){var e=t.data;X(t,e,t,v)}function s(){v()}function v(){L(document,Q.move,f),L(document,Q.cancel,s)}function p(t){var e,n;z[t.target.tagName.toLowerCase()]||(e=t.changedTouches[0],n={target:e.target,startX:e.pageX,startY:e.pageY,timeStamp:t.timeStamp,identifier:e.identifier},K(document,B.move+"."+e.identifier,g,n),K(document,B.cancel+"."+e.identifier,h,n))}function g(t){var e=t.data,n=d(t,e);n&&X(t,e,n,l)}function h(t){var e=t.data,n=c(t.changedTouches,e.identifier);n&&l(e.identifier)}function l(t){L(document,"."+t,g),L(document,"."+t,h)}function X(t,e,n,a){var i=n.pageX-e.startX,o=n.pageY-e.startY;C*C>i*i+o*o||y(t,e,n,i,o,a)}function Y(){return this._handled=a,!1}function w(t){t._handled()}function y(t,e,n,a,i,o){{var r,u;e.target}r=t.targetTouches,u=t.timeStamp-e.timeStamp,e.type="movestart",e.distX=a,e.distY=i,e.deltaX=a,e.deltaY=i,e.pageX=n.pageX,e.pageY=n.pageY,e.velocityX=a/u,e.velocityY=i/u,e.targetTouches=r,e.finger=r?r.length:1,e._handled=Y,e._preventTouchmoveDefault=function(){t.preventDefault()},N(e.target,e),o(e.identifier)}function T(t){var e=t.data.timer;t.data.touch=t,t.data.timeStamp=t.timeStamp,e.kick()}function S(t){var e=t.data.event,n=t.data.timer;k(),F(e,n,function(){setTimeout(function(){L(e.target,"click",i)},0)})}function k(){L(document,Q.move,T),L(document,Q.end,S)}function _(t){var e=t.data.event,n=t.data.timer,a=d(t,e);a&&(t.preventDefault(),e.targetTouches=t.targetTouches,t.data.touch=a,t.data.timeStamp=t.timeStamp,n.kick())}function q(t){var e=t.data.event,n=t.data.timer,a=c(t.changedTouches,e.identifier);a&&(A(e),F(e,n))}function A(t){L(document,"."+t.identifier,_),L(document,"."+t.identifier,q)}function D(t,e,n){var a=n-t.timeStamp;t.type="move",t.distX=e.pageX-t.startX,t.distY=e.pageY-t.startY,t.deltaX=e.pageX-t.pageX,t.deltaY=e.pageY-t.pageY,t.velocityX=.3*t.velocityX+.7*t.deltaX/a,t.velocityY=.3*t.velocityY+.7*t.deltaY/a,t.pageX=e.pageX,t.pageY=e.pageY}function F(t,e,n){e.end(function(){return t.type="moveend",N(t.target,t),n&&n()})}function R(){return K(this,"movestart.move",w),!0}function x(){return L(this,"dragstart drag",o),L(this,"mousedown touchstart",r),L(this,"movestart",w),!0}function b(t){"move"!==t.namespace&&"moveend"!==t.namespace&&(K(this,"dragstart."+t.guid+" drag."+t.guid,o,e,t.selector),K(this,"mousedown."+t.guid,r,e,t.selector))}function j(t){"move"!==t.namespace&&"moveend"!==t.namespace&&(L(this,"dragstart."+t.guid+" drag."+t.guid),L(this,"mousedown."+t.guid))}var C=6,K=t.event.add,L=t.event.remove,N=function(e,n,a){t.event.trigger(n,a,e)},O=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(function(){t()},25)}}(),z={textarea:!0,input:!0,select:!0,button:!0},Q={move:"mousemove",cancel:"mouseup dragstart",end:"mouseup"},B={move:"touchmove",cancel:"touchend",end:"touchend"};t.event.special.movestart={setup:R,teardown:x,add:b,remove:j,_default:function(t){function a(){D(o,r.touch,r.timeStamp),N(t.target,o)}var o,r;t._handled()&&(o={target:t.target,startX:t.startX,startY:t.startY,pageX:t.pageX,pageY:t.pageY,distX:t.distX,distY:t.distY,deltaX:t.deltaX,deltaY:t.deltaY,velocityX:t.velocityX,velocityY:t.velocityY,timeStamp:t.timeStamp,identifier:t.identifier,targetTouches:t.targetTouches,finger:t.finger},r={event:o,timer:new n(a),touch:e,timeStamp:e},t.identifier===e?(K(t.target,"click",i),K(document,Q.move,T,r),K(document,Q.end,S,r)):(t._preventTouchmoveDefault(),K(document,B.move+"."+t.identifier,_,r),K(document,B.end+"."+t.identifier,q,r)))}},t.event.special.move={setup:function(){K(this,"movestart.move",t.noop)},teardown:function(){L(this,"movestart.move",t.noop)}},t.event.special.moveend={setup:function(){K(this,"movestart.moveend",t.noop)},teardown:function(){L(this,"movestart.moveend",t.noop)}},K(document,"mousedown.move",m),K(document,"touchstart.move",p),"function"==typeof Array.prototype.indexOf&&!function(t){for(var e=["changedTouches","targetTouches"],n=e.length;n--;)-1===t.event.props.indexOf(e[n])&&t.event.props.push(e[n])}(t)});
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){function e(t){var e,i,s;e=t.currentTarget.offsetWidth,i=t.currentTarget.offsetHeight,s={distX:t.distX,distY:t.distY,velocityX:t.velocityX,velocityY:t.velocityY,finger:t.finger},t.distX>t.distY?t.distX>-t.distY?(t.distX/e>d.threshold||t.velocityX*t.distX/e*d.sensitivity>1)&&(s.type="swiperight",r(t.currentTarget,s)):(-t.distY/i>d.threshold||t.velocityY*t.distY/e*d.sensitivity>1)&&(s.type="swipeup",r(t.currentTarget,s)):t.distX>-t.distY?(t.distY/i>d.threshold||t.velocityY*t.distY/e*d.sensitivity>1)&&(s.type="swipedown",r(t.currentTarget,s)):(-t.distX/e>d.threshold||t.velocityX*t.distX/e*d.sensitivity>1)&&(s.type="swipeleft",r(t.currentTarget,s))}function i(e){var i=t.data(e,"event_swipe");return i||(i={count:0},t.data(e,"event_swipe",i)),i}var s=t.event.add,n=t.event.remove,r=function(e,i,s){t.event.trigger(i,s,e)},d={threshold:.4,sensitivity:6};t.event.special.swipe=t.event.special.swipeleft=t.event.special.swiperight=t.event.special.swipeup=t.event.special.swipedown={setup:function(t){var t=i(this);if(!(t.count++>0))return s(this,"moveend",e),!0},teardown:function(){var t=i(this);if(!(--t.count>0))return n(this,"moveend",e),!0},settings:d}});
!function(e){function n(e,n){for(var t=e.length;t--;)if(e[t]===n)return t;return-1}function t(e,n){if(e.length!=n.length)return!1;for(var t=0;t<e.length;t++)if(e[t]!==n[t])return!1;return!0}function o(e){for(m in b)b[m]=e[T[m]]}function r(e){var t,r,i,l,c,u;if(t=e.keyCode,-1==n(S,t)&&S.push(t),(93==t||224==t)&&(t=91),t in b){b[t]=!0;for(i in C)C[i]==t&&(f[i]=!0)}else if(o(e),f.filter.call(this,e)&&t in E)for(u=p(),l=0;l<E[t].length;l++)if(r=E[t][l],r.scope==u||"all"==r.scope){c=r.mods.length>0;for(i in b)(!b[i]&&n(r.mods,+i)>-1||b[i]&&-1==n(r.mods,+i))&&(c=!1);(0!=r.mods.length||b[16]||b[18]||b[17]||b[91])&&!c||r.method(e,r)===!1&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0))}}function i(e){var t,o=e.keyCode,r=n(S,o);if(r>=0&&S.splice(r,1),(93==o||224==o)&&(o=91),o in b){b[o]=!1;for(t in C)C[t]==o&&(f[t]=!1)}}function l(){for(m in b)b[m]=!1;for(m in C)f[m]=!1}function f(e,n,t){var o,r;o=g(e),void 0===t&&(t=n,n="all");for(var i=0;i<o.length;i++)r=[],e=o[i].split("+"),e.length>1&&(r=v(e),e=[e[e.length-1]]),e=e[0],e=P(e),e in E||(E[e]=[]),E[e].push({shortcut:o[i],scope:n,method:t,key:o[i],mods:r})}function c(e,n){var o,r,i,l,f,c=[];for(o=g(e),l=0;l<o.length;l++){if(r=o[l].split("+"),r.length>1&&(c=v(r)),e=r[r.length-1],e=P(e),void 0===n&&(n=p()),!E[e])return;for(i=0;i<E[e].length;i++)f=E[e][i],f.scope===n&&t(f.mods,c)&&(E[e][i]={})}}function u(e){return"string"==typeof e&&(e=P(e)),-1!=n(S,e)}function a(){return S.slice(0)}function s(e){var n=(e.target||e.srcElement).tagName;return!("INPUT"==n||"SELECT"==n||"TEXTAREA"==n)}function d(e){w=e||"all"}function p(){return w||"all"}function h(e){var n,t,o;for(n in E)for(t=E[n],o=0;o<t.length;)t[o].scope===e?t.splice(o,1):o++}function g(e){var n;return e=e.replace(/\s/g,""),n=e.split(","),""==n[n.length-1]&&(n[n.length-2]+=","),n}function v(e){for(var n=e.slice(0,e.length-1),t=0;t<n.length;t++)n[t]=C[n[t]];return n}function y(e,n,t){e.addEventListener?e.addEventListener(n,t,!1):e.attachEvent&&e.attachEvent("on"+n,function(){t(window.event)})}function k(){var n=e.key;return e.key=A,n}var m,E={},b={16:!1,18:!1,17:!1,91:!1},w="all",C={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},K={backspace:8,tab:9,clear:12,enter:13,"return":13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,"delete":46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},P=function(e){return K[e]||e.toUpperCase().charCodeAt(0)},S=[];for(m=1;20>m;m++)K["f"+m]=111+m;var T={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};for(m in C)f[m]=!1;y(document,"keydown",function(e){r(e)}),y(document,"keyup",i),y(window,"focus",l);var A=e.key;e.key=f,e.key.setScope=d,e.key.getScope=p,e.key.deleteScope=h,e.key.filter=s,e.key.isPressed=u,e.key.getPressedKeyCodes=a,e.key.noConflict=k,e.key.unbind=c,"undefined"!=typeof module&&(module.exports=f)}(this);
var ArrayProto,nativeForEach,nativeIsArray,nativeMap,nativeReduce,__hasProp={}.hasOwnProperty;("undefined"==typeof _||null===_)&&(this._={},ArrayProto=Array.prototype,nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeIsArray=Array.isArray,_.isObject=function(n){var r;return r=typeof n,"function"===r||"object"===r&&!!n},_.after=function(n,r){return function(){return--n<1?r.apply(this,arguments):void 0}},_.each=function(n,r,t){var e,a,u,o,i,c;try{if(nativeForEach&&n.forEach===nativeForEach)n.forEach(r,t);else if(_.isNumber(n.length))for(a=i=0,c=n.length;c>=0?c>i:i>c;a=c>=0?++i:--i)r.call(t,n[a],a,n);else for(u in n)__hasProp.call(n,u)&&(o=n[u],r.call(t,o,u,n))}catch(l){e=l}return n},_.map=function(n,r,t){var e;return nativeMap&&n.map===nativeMap?n.map(r,t):(e=[],_.each(n,function(n,a,u){return e.push(r.call(t,n,a,u))}),e)},_.reduce=function(n,r,t,e){return nativeReduce&&n.reduce===nativeReduce?(e&&(r=_.bind(r,e)),n.reduce(r,t)):(_.each(n,function(n,a,u){return t=r.call(e,t,n,a,u)}),t)},_.isArray=nativeIsArray||function(n){return!(!(n&&n.concat&&n.unshift)||n.callee)},_.max=function(n,r,t){var e;return!r&&_.isArray(n)?Math.max.apply(Math,n):(e={computed:-1/0},_.each(n,function(n,a,u){var o;return o=r?r.call(t,n,a,u):n,o>=e.computed&&(e={value:n,computed:o})}),e.value)},_.min=function(n,r,t){var e;return!r&&_.isArray(n)?Math.min.apply(Math,n):(e={computed:1/0},_.each(n,function(n,a,u){var o;return o=r?r.call(t,n,a,u):n,o<e.computed&&(e={value:n,computed:o})}),e.value)},_.now=Date.now||function(){return(new Date).getTime()},_.throttle=function(n,r,t){var e,a,u,o,i,c;return a=void 0,e=void 0,i=void 0,c=null,o=0,t||(t={}),u=function(){o=t.leading===!1?0:_.now(),c=null,i=n.apply(a,e),a=e=null},function(){var l,v;return l=_.now(),o||t.leading!==!1||(o=l),v=r-(l-o),a=this,e=arguments,0>=v?(clearTimeout(c),c=null,o=l,i=n.apply(a,e),a=e=null):c||t.trailing===!1||(c=setTimeout(u,v)),i}},_.debounce=function(n,r,t){var e,a,u,o,i,c;return i=void 0,e=void 0,a=void 0,c=void 0,o=void 0,u=function(){var l;l=_.now()-c,r>l?i=setTimeout(u,r-l):(i=null,t||(o=n.apply(a,e),a=e=null))},function(){var l;return a=this,e=arguments,c=_.now(),l=t&&!i,i||(i=setTimeout(u,r)),l&&(o=n.apply(a,e),a=e=null),o}});
(function(){var t,i,o=function(t,i){return function(){return t.apply(i,arguments)}};this.Chromatic=this.Chromatic||{},t=function(){var t;return t={},function(i,o){var n,r,e,s,h,a,u,c,l,p,f,d,m,v,g,y,w,I;if(s=i.join()+o,t[s])return t[s];if(u=i.length,0>=o)return[];if(o>u)return i.map(function(t){return[t]});for(y=function(){var t,i,n;for(n=[],I=t=0,i=u;i>=0?i>t:t>i;I=i>=0?++t:--t)n.push(function(){var t,i,n;for(n=[],w=t=0,i=o;i>=0?i>t:t>i;w=i>=0?++t:--t)n.push(0);return n}());return n}(),g=function(){var t,i,n;for(n=[],I=t=0,i=u-1;i>=0?i>t:t>i;I=i>=0?++t:--t)n.push(function(){var t,i,n;for(n=[],w=t=0,i=o-1;i>=0?i>t:t>i;w=i>=0?++t:--t)n.push(0);return n}());return n}(),r=h=0,p=u;p>=0?p>h:h>p;r=p>=0?++h:--h)y[r][0]=i[r]+(r?y[r-1][0]:0);for(e=c=0,f=o;f>=0?f>c:c>f;e=f>=0?++c:--c)y[0][e]=i[0];for(r=l=1,d=u;d>=1?d>l:l>d;r=d>=1?++l:--l)for(e=v=1,m=o;m>=1?m>v:v>m;e=m>=1?++v:--v)a=_.min(function(){var t,i,o;for(i=[],w=o=0,t=r;t>=0?t>o:o>t;w=t>=0?++o:--o)i.push([_.max([y[w][e-1],y[r][0]-y[w][0]]),w]);return i}(),function(t){return t[0]}),y[r][e]=a[0],g[r-1][e-1]=a[1];for(u-=1,o-=2,n=[];o>=0;)n=[function(){var t,n,e,s;for(e=[],r=s=t=g[u-1][o]+1,n=u+1;n>=t?n>s:s>n;r=n>=t?++s:--s)e.push(i[r]);return e}()].concat(n),u=g[u-1][o],o-=1;return t[s]=[function(){var t,o,n;for(o=[],r=n=0,t=u+1;t>=0?t>n:n>t;r=t>=0?++n:--n)o.push(i[r]);return o}()].concat(n)}}(),i=function(){var t;return t=null,function(){var i,o,n;return t?t:(i=$('<div style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div></div>'),$(document.body).append(i),o=$("div",i).innerWidth(),i.css("overflow-y","auto"),n=$("div",i).innerWidth(),$(i).remove(),t=o-n)}}(),Chromatic.GalleryView=function(){function n(t,i,n){this.layout=o(this.layout,this),this.lazyLoad=o(this.lazyLoad,this),this.calculateAspectRatios=o(this.calculateAspectRatios,this),t[0]===document.body?(this.el=$('<div class="chromatic-gallery-full"/>'),$(t).append(this.el)):this.el=$(t).addClass("chromatic-gallery"),this.photos=_.map(i,function(t){return _.isObject(t)?t:{small:t}}),this.photo_views=_.map(this.photos,function(t){return function(i){return new Chromatic.GalleryPhotoView(t,i,n)}}(this)),this.ideal_height=parseInt(this.el.children().first().css("height")),$(window).on("resize",_.debounce(this.layout,100)),this.el.on("scroll",_.throttle(this.lazyLoad,100)),this.photos[0].aspect_ratio?this.layout():this.calculateAspectRatios()}return n.prototype.calculateAspectRatios=function(){var t;return t=_.after(this.photos.length,this.layout),_.each(this.photo_views,function(i){return i.load(t)})},n.prototype.lazyLoad=function(){var t,i,o;return t=1e3,o=this.el.scrollTop()-t,i=(this.el.height()||$(window).height())+this.el.scrollTop()+t,_.each(this.photo_views,function(){return function(t){return t.top<i&&t.bottom>o?t.load():t.unload()}}(this))},n.prototype.layout=function(){var o,n,r,e,s,h,a;return $(document.body).css("overflowY","scroll"),h=this.el[0].getBoundingClientRect().width-parseInt(this.el.css("paddingLeft"))-parseInt(this.el.css("paddingRight")),this.el[0].offsetWidth>this.el[0].scrollWidth&&(h-=i()),$(document.body).css("overflowY","auto"),o=this.ideal_height||parseInt((this.el.height()||$(window).height())/2),s=_.reduce(this.photos,function(t,i){return t+=i.aspect_ratio*o},0),e=Math.round(s/h),1>e?_.each(this.photos,function(t){return function(i,n){return t.photo_views[n].resize(parseInt(o*i.aspect_ratio),o)}}(this)):(a=_.map(this.photos,function(t){return parseInt(100*t.aspect_ratio)}),r=t(a,e),n=0,_.each(r,function(t){return function(i){var o,r;return o=[],_.each(i,function(i,r){return o.push(t.photos[n+r])}),r=_.reduce(o,function(t,i){return t+=i.aspect_ratio},0),s=0,_.each(o,function(i,e){var a,u;return u=e===o.length-1?h-s:parseInt(h/r*i.aspect_ratio),a=parseInt(h/r),t.photo_views[n+e].resize(u,a),s+=u}),n+=i.length}}(this))),this.lazyLoad()},n}()}).call(this),function(){var t=function(t,i){return function(){return t.apply(i,arguments)}};this.Chromatic=this.Chromatic||{},Chromatic.GalleryPhotoView=function(){function i(i,o){this.unload=t(this.unload,this),this.load=t(this.load,this),this.parent=i,this.photo=o,this.el=$('<div class="chromatic-gallery-photo"/>'),i.el.append(this.el)}return i.prototype.load=function(t){var i;if(!this.loaded)return i=new Image,i.onload=function(o){return function(){var n,r,e;o.photo.aspect_ratio=i.width/i.height,t&&t(),o.el.css("backgroundImage","url("+o.photo.small+")"),r=o.photo;for(n in r)e=r[n],(n.startsWith("data")||n.startsWith("mfp"))&&o.el.attr(n,e);return o.loaded=!0}}(this),i.src=this.photo.small},i.prototype.unload=function(){return this.el.css("backgroundImage",""),this.loaded=!1},i.prototype.resize=function(t,i){return this.el.css({width:t-parseInt(this.el.css("marginLeft"))-parseInt(this.el.css("marginRight")),height:i-parseInt(this.el.css("marginTop"))-parseInt(this.el.css("marginBottom"))}),this.top=this.el.position().top,this.bottom=this.top+this.el.height()},i}()}.call(this),function(){$.fn.extend({chromatic:function(t,i){return new Chromatic.GalleryView(this,t,i),this}})}.call(this);